@startuml
title UC02 - Account Lock (Class Diagram)
skinparam style strictuml
skinparam classAttributeIconSize 0
skinparam packageStyle rectangle
top to bottom direction
hide empty members

class User {
  id: string
}

class LoginPage {
  submitLogin()
}

class AuthRouter {
  POST /auth/login
}

class AuthController {
  login(email: string, password: string, ip: string) -> AuthResultView
}

class AuthResultView {
  success
  message
  token
  lockedUntil: Date
}

class UserModel {
  findByEmail(email: string)
}

class LoginAttemptModel {
  record(userId: string, success: boolean, ip: string, at: Date)
  countFailedSince(userId: string, since: Date)
}

class AccountLockPolicy {
  lockoutDurationMs: number
  shouldLock(failedInWindow: number) -> boolean
  calculateUnlockTime(now: Date) -> Date
}

User -down-> LoginPage
LoginPage -down-> AuthRouter
AuthRouter -down-> AuthController
AuthController -down-> AuthResultView
AuthController -down-> UserModel
AuthController -down-> LoginAttemptModel
AuthController -down-> AccountLockPolicy

@enduml
