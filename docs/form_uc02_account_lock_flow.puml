@startuml
title UC02 - Account Lock (Form)
skinparam style strictuml
skinparam classAttributeIconSize 0
top to bottom direction

class User <<actor>> {
  id: ObjectId
}

class LoginPage {
  submitLogin()
}

class AuthRouter {
  POST /auth/login
}

class AuthController {
  login(email, password, ip) -> LoginResultView
}

class UserModel {
  findByEmail(email)
  recordFailure(id, when)
  lockIfExceeded(id) -> DateTime
}

class LoginResultView {
  success
  message
  lockedUntil
  token
}

User --> LoginPage
LoginPage --> AuthRouter
AuthRouter --> AuthController
AuthController --> UserModel
AuthController --> LoginResultView

@enduml

